!function(e){function t(t){for(var i,a,o=t[0],n=t[1],c=t[2],p=0,u=[];p<o.length;p++)a=o[p],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&u.push(r[a][0]),r[a]=0;for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);for(d&&d(t);u.length;)u.shift()();return l.push.apply(l,c||[]),s()}function s(){for(var e,t=0;t<l.length;t++){for(var s=l[t],i=!0,o=1;o<s.length;o++){var n=s[o];0!==r[n]&&(i=!1)}i&&(l.splice(t--,1),e=a(a.s=s[0]))}return e}var i={},r={1:0},l=[];function a(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=i,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(s,i,function(t){return e[t]}.bind(null,i));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="./";var o=window.webpackJsonp=window.webpackJsonp||[],n=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=n;l.push([105,0,2]),s()}({105:function(e,t,s){e.exports=s(174)},116:function(e,t){},118:function(e,t){},174:function(e,t,s){"use strict";s.r(t);s(106);var i=s(2);var r=[function(e,t,s){return["@media (display-mode:standalone){.app",t,"{border-top:1px solid #fff}}.app",t,"{display:flex;flex-direction:column;width:100%;height:100%}.body",t,"{flex:1;flex-direction:row}.body",t,",.left-panel",t,"{display:flex;background-color:#fff}.left-panel",t,"{height:100%;width:300px;position:relative;border-right:1px solid #dddbda}.right-panel",t,"{display:flex;flex:1;flex-direction:column}.right-top-panel",t,"{border-bottom:1px solid #dddbda;height:300px;display:flex}.right-top-left-panel",t,"{flex:1;border-right:1px solid #dddbda;display:flex;flex-direction:column}.right-top-right-panel",t,"{width:300px}.right-bottom-panel",t,"{flex:1;display:flex;flex-direction:column}"].join("")}],l=s(11),a=s.n(l);function o(e,t,s,i){const{t:r,h:l}=e;return[l("div",{classMap:{"slds-spinner_container":!0},key:4},[l("div",{className:t.className,attrs:{role:"status"},key:3},[l("span",{classMap:{"slds-assistive-text":!0},key:0},[r("Loading")]),l("div",{classMap:{"slds-spinner__dot-a":!0},key:1},[]),l("div",{classMap:{"slds-spinner__dot-b":!0},key:2},[])])])]}var n=Object(i.registerTemplate)(o);o.stylesheets=[],a.a&&o.stylesheets.push.apply(o.stylesheets,a.a),o.stylesheetTokens={hostAttribute:"base-spinner-_spinner-host",shadowAttribute:"base-spinner-_spinner"};class c extends i.LightningElement{constructor(...e){super(...e),this.size="medium"}close(){this.template.host.remove()}get className(){return`slds-spinner slds-spinner_${this.size} slds-spinner_brand`}}Object(i.registerDecorators)(c,{publicProps:{size:{config:0}},publicMethods:["close"]});var d=Object(i.registerComponent)(c,{tmpl:n});var p=[function(e,t,s){return[".header-logo",t,"{height:43.2px;width:180px}"].join("")}];function u(e,t,s,r){const{h:l,t:a,d:o,b:n}=e,{_m0:c}=r;return[l("header",{classMap:{"slds-builder-header":!0},key:20},[l("div",{classMap:{"slds-builder-header__item":!0},key:3},[l("div",{classMap:{"slds-builder-header__item-label":!0,"slds-media":!0,"slds-media_center":!0},key:2},[l("a",{attrs:{href:"/"},key:1},[l("img",{classMap:{"header-logo":!0},attrs:{src:"./resources/imgs/logo_white.svg"},key:0},[])])])]),l("div",{classMap:{"slds-builder-header__item":!0,"slds-builder-header__utilities":!0},key:19},[t.apiUsage?l("div",{classMap:{"slds-builder-header__utilities-item":!0},key:5},[l("h1",{classMap:{"slds-builder-header__item-label":!0},key:4},[a("API Usage: "),o(t.apiUsage)])]):null,t.userLabel?l("div",{classMap:{"slds-builder-header__utilities-item":!0},key:7},[l("h1",{classMap:{"slds-builder-header__item-label":!0},key:6},[o(t.userLabel)])]):null,t.isLoggedIn?l("div",{classMap:{"slds-builder-header__utilities-item":!0},key:14},[l("a",{classMap:{"slds-builder-header__item-action":!0,"slds-media":!0,"slds-media_center":!0},attrs:{href:"javascript:void(0);"},key:13,on:{click:c||(r._m0=n(t.logout))}},[l("div",{classMap:{"slds-media__figure":!0},key:11},[l("span",{classMap:{"slds-icon_container":!0,"slds-icon-utility-logout":!0,"slds-current-color":!0},key:10},[l("svg",{classMap:{"slds-icon":!0,"slds-icon_x-small":!0},attrs:{"aria-hidden":"true"},key:9},[l("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#logout")},key:8},[])])])]),l("div",{classMap:{"slds-media__body":!0},key:12},[a("Logout")])])]):null,l("div",{classMap:{"slds-builder-header__utilities-item":!0},key:18},[l("a",{classMap:{"slds-builder-header__item-action":!0,"slds-media":!0,"slds-media_center":!0},attrs:{href:"https://github.com/lwc-soql-builder/lwc-soql-builder",target:"_blank"},key:17},[l("span",{classMap:{"slds-avatar":!0},key:16},[l("img",{attrs:{src:"./resources/imgs/GitHub-Mark-Light-64px.png"},key:15},[])])])])])])]}var h=Object(i.registerTemplate)(u);u.stylesheets=[],p&&u.stylesheets.push.apply(u.stylesheets,p),u.stylesheetTokens={hostAttribute:"cmp-header-_header-host",shadowAttribute:"cmp-header-_header"};var b=s(41),m=s(102);function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(Object(s),!0).forEach((function(t){f(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function f(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function v(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach((function(t){O(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function O(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function k(e={isFetching:!1,data:null,error:null},t){switch(t.type){case"REQUEST_SOBJECT":return v(v({},e),{},{isFetching:!0});case"RECEIVE_SOBJECT_SUCCESS":return v(v({},e),{},{isFetching:!1,data:t.payload.data,error:null});case"RECEIVE_SOBJECT_ERROR":return v(v({},e),{},{isFetching:!1,data:void 0,error:t.payload.error});case"CLEAR_SOBJECT_ERROR":return v(v({},e),{},{error:void 0});default:return e}}function j(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function w(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?j(Object(s),!0).forEach((function(t){x(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):j(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function x(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var E=s(4);var M=s(20),S=s.n(M);function C(e){return e?e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"):""}const R=new RegExp("^([a-z_]?[a-z])+(?:__[cr]|__Share|__latitude__s|__longitude__s)$","i");let L,P,T;function A(){return"ja"===navigator.language?"https://asia-northeast1-lwc-soql-builder.cloudfunctions.net/asia_northeast1/proxy/":"https://us-central1-lwc-soql-builder.cloudfunctions.net/us_central1/proxy/"}function F(){return{clientId:"3MVG9n_HvETGhr3Bp2TP0lUhBaOTAOuCH9OKmjFKsspVG.z8WOx0Vb94skZ8d4wHTVuMf5DArbdwCb05yIAT5",redirectUri:`${window.location.origin}${window.location.pathname}`,version:T,proxyUrl:A()}}async function q(e){e=e||(()=>{});try{const t=await L.request("/services/oauth2/userinfo");await async function(){if(T=sessionStorage.getItem("lsb.apiVersion"),T)L.version=T;else{const e=await L.request("/services/data/");T=e[e.length-1].version,L.version=T,sessionStorage.setItem("lsb.apiVersion",T)}}();const s=await L.metadata.describe(T);P=s.organizationNamespace,e(null,t)}catch(t){e(t),D()}}function D(){L=null,S.a.browser.logout(),te.dispatch({type:"LOGOUT"})}function I(e){window.open=()=>null,S.a.browser.login({loginUrl:e})}function N(){return!(!L||!L.accessToken)}function U(){return P?{"Sforce-Call-Options":"defaultNamespace="+P}:{}}function Q(e){return e?P&&R.test(e)?`${P}__${e}`:e:null}function $(e){return e?P?Array.isArray(e)?e.map(e=>Q(e)):e.split(".").map(e=>Q(e)).join("."):e:null}function B(e){if(!e)return null;if(!P)return e;const t=C(P),s=new RegExp(`^${t}__(.*)$`,"i"),i=e.match(s);return i?i[1]:e}function z(e){return e?P?Array.isArray(e)?e.map(e=>B(e)):e.split(".").map(e=>B(e)).join("."):e:null}function V(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function J(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?V(Object(s),!0).forEach((function(t){G(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):V(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function G(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const H={fields:[Object(E.b)("Id")],sObject:void 0};function K(e,t){return t?`${t}.${e}`:e}function Y(e,t,s){t=z(t),s=z(s);const i=z(Object(E.c)(e)),r=z(K(t,s));return i.includes(r)?J(J({},e),{},{fields:e.fields.filter(e=>{const t=e.relationships&&e.relationships.join(".");return z(K(e.field,t))!==r})}):J(J({},e),{},s?{fields:[...e.fields,Object(E.b)({field:t,relationships:s.split(".")})]}:{fields:[...e.fields,Object(E.b)(t)]})}function W(e=[],t){const{soql:s}=t.payload,i=[s,...e.filter(e=>e!==s).slice(0,19)];try{localStorage.setItem("lsb.recentQueries",JSON.stringify(i))}catch(e){console.warn("Failed to save recent queries from localStorage",e)}return i}function Z(){try{const e=localStorage.getItem("lsb.recentQueries");if(e)return JSON.parse(e)}catch(e){console.warn("Failed to load recent queries from localStorage",e)}return[]}function X(e=H,t){const{fieldName:s,relationships:i,childRelationship:r}=t.payload;return r?function(e,t,s,i){t=z(t),i=z(i);const r=e.fields.find(e=>e.subquery&&z(e.subquery.relationshipName)===i);if(!r)return J(J({},e),{},{fields:[...e.fields,Object(E.b)({subquery:{fields:[Object(E.b)(t)],relationshipName:i}})]});s=z(s);const l=Y(r.subquery,t,s),a=e.fields.map(e=>e.subquery&&z(e.subquery.relationshipName)===i?J(J({},e),{},{subquery:l}):e);return J(J({},e),{},{fields:a})}(e,s,i,r):Y(e,s,i)}let ee=[m.a];const te=Object(b.c)(Object(b.b)({sobjects:function(e={isFetching:!1,data:null,error:null},t){switch(t.type){case"REQUEST_SOBJECTS":return _(_({},e),{},{isFetching:!0});case"RECEIVE_SOBJECTS_SUCCESS":return _(_({},e),{},{isFetching:!1,data:t.payload.data,error:null});case"RECEIVE_SOBJECTS_ERROR":return _(_({},e),{},{isFetching:!1,data:void 0,error:t.payload.error});case"CLEAR_SOBJECTS_ERROR":return _(_({},e),{},{error:void 0});default:return e}},sobject:function(e={},t){switch(t.type){case"REQUEST_SOBJECT":case"RECEIVE_SOBJECT_SUCCESS":case"RECEIVE_SOBJECT_ERROR":case"CLEAR_SOBJECT_ERROR":{const s=e[t.payload.sObjectName];return v(v({},e),{},{[t.payload.sObjectName]:k(s,t)})}default:return e}},query:function(e={isFetching:!1,data:null,error:null},t){switch(t.type){case"REQUEST_QUERY":return w(w({},e),{},{isFetching:!0,data:void 0,error:void 0});case"RECEIVE_QUERY_SUCCESS":return w(w({},e),{},{isFetching:!1,data:t.payload.data,error:void 0});case"RECEIVE_QUERY_ERROR":return w(w({},e),{},{isFetching:!1,data:void 0,error:t.payload.error});case"CLEAR_QUERY_ERROR":return w(w({},e),{},{error:void 0});default:return e}},ui:function(e={},t){switch(t.type){case"LOGIN":return J(J({},e),{},{isLoggedIn:!0,user:t.payload.user});case"LOGOUT":return J(J({},e),{},{isLoggedIn:!1});case"UPDATE_API_LIMIT":{const{limitInfo:t}=L;return J(J({},e),{},{apiUsage:t?t.apiUsage:void 0})}case"RECEIVE_QUERY_SUCCESS":return J(J({},e),{},{recentQueries:W(e.recentQueries,t),childRelationship:void 0});case"LOAD_RECENT_QUERIES":return J(J({},e),{},{recentQueries:Z()});case"SELECT_SOBJECT":{const{sObjectName:s}=t.payload,i=J(J({},H),{},{sObject:z(s)});return J(J({},e),{},{selectedSObject:s,query:i,soql:Object(E.a)(i,{format:!0})})}case"DESELECT_SOBJECT":return J(J({},e),{},{selectedSObject:void 0});case"TOGGLE_FIELD":{const s=X(e.query,t);return J(J({},e),{},{query:s,soql:Object(E.a)(s,{format:!0})})}case"TOGGLE_RELATIONSHIP":{const s=function(e=[],t){const{relationshipName:s}=t.payload,i=z(s);if(z(Object(E.c)(e)).includes(i))return J(J({},e),{},{fields:e.fields.filter(e=>!e.subquery||z(e.subquery.relationshipName)!==i)});const r={fields:[Object(E.b)("Id")],relationshipName:i};return J(J({},e),{},{fields:[...e.fields,Object(E.b)({subquery:r})]})}(e.query,t);return J(J({},e),{},{query:s,soql:Object(E.a)(s,{format:!0})})}case"UPDATE_SOQL":{const{soql:s}=t.payload;if(!s.trim())return J(J({},e),{},{selectedSObject:void 0,query:void 0,soql:s});const i=Object(E.d)(s)?Object(E.e)(s):e.query;return J(J({},e),{},{selectedSObject:i?i.sObject:void 0,query:i,soql:s})}case"FORMAT_SOQL":return J(J({},e),{},{soql:Object(E.a)(e.query,{format:!0})});case"SELECT_CHILD_RELATIONSHIP":return J(J({},e),{},{childRelationship:t.payload.childRelationship});case"DESELECT_CHILD_RELATIONSHIP":return J(J({},e),{},{childRelationship:void 0});case"SELECT_ALL_FIELDS":{const s=function(e=H,t){const{sObjectMeta:s}=t.payload;return J(J({},e),{},{fields:s.fields.map(e=>Object(E.b)(z(e.name)))})}(e.query,t);return J(J({},e),{},{query:s,soql:Object(E.a)(s,{format:!0})})}case"CLEAR_ALL_FIELDS":{const t=function(e=H){return J(J({},e),{},{fields:[Object(E.b)("Id")]})}(e.query);return J(J({},e),{},{query:t,soql:Object(E.a)(t,{format:!0})})}default:return e}}}),Object(b.a)(...ee));class se{constructor(e){this.dataCallback=void 0,this.store=void 0,this.subscription=void 0,this.connected=!1,this.dataCallback=e}connect(){this.connected=!0,this.subscribeToStore()}disconnect(){this.unsubscribeFromStore(),this.connected=!1}update(e){this.unsubscribeFromStore(),this.store=e.store,this.subscribeToStore()}subscribeToStore(){if(this.connected&&this.store){const e=()=>{const e=this.store.getState();this.dataCallback(e)};this.subscription=this.store.subscribe(e),e()}}unsubscribeFromStore(){this.subscription&&(this.subscription(),this.subscription=void 0)}}function ie(e){return{type:"UPDATE_SOQL",payload:{soql:e}}}function re(){return(e,t)=>{(function({sobjects:e}){return!e||!e.data})(t())&&e(async e=>{N()&&(e({type:"REQUEST_SOBJECTS"}),L.describeGlobal().then(t=>{e({type:"RECEIVE_SOBJECTS_SUCCESS",payload:{data:t}}),e({type:"UPDATE_API_LIMIT"})}).catch(t=>{e({type:"RECEIVE_SOBJECTS_ERROR",payload:{error:t}})}))})}}function le(e){return(t,s)=>{(function({sobject:e},t){return!e[t]||!e[t].data})(s(),e)&&t(function(e){return async t=>{N()&&(t(function(e){return{type:"REQUEST_SOBJECT",payload:{sObjectName:e}}}(e)),L.describe(e).then(s=>{t(function(e,t){return{type:"RECEIVE_SOBJECT_SUCCESS",payload:{sObjectName:e,data:t}}}(e,s)),t({type:"UPDATE_API_LIMIT"})}).catch(s=>{t(function(e,t){return{type:"RECEIVE_SOBJECT_ERROR",payload:{sObjectName:e,error:t}}}(e,s))}))}}(e))}}Object(i.registerDecorators)(se,{fields:["dataCallback","store","subscription","connected"]});class ae extends i.LightningElement{constructor(...e){super(...e),this.isLoggedIn=void 0,this._user=void 0,this._apiUsage=void 0}get userLabel(){return this._user?`${this._user.name}(${this._user.preferred_username})`:""}get apiUsage(){return this._apiUsage?`${this._apiUsage.used}/${this._apiUsage.limit}`:""}storeChange({ui:e}){this.isLoggedIn=e.isLoggedIn,this._user=e.user,this._apiUsage=e.apiUsage}logout(){D()}}Object(i.registerDecorators)(ae,{wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["isLoggedIn","_user","_apiUsage"]});var oe=Object(i.registerComponent)(ae,{tmpl:h});var ne=[function(e,t,s){return[s?[".slds-tree_container",t,",:host{width:100%;display:flex}"].join(""):[".slds-tree_container",t,",",e,"{width:100%;display:flex}"].join(""),".slds-tree_container",t,"{flex-direction:column}.slds-tree__group-header",t,"{padding:.5rem .5rem .5rem 1rem;font-size:1rem;font-weight:700}.sobjects-list",t,"{flex:1;position:relative;margin-top:.5rem}.slds-tabs_default__content",t,"{position:absolute;height:100%;left:0;right:0;padding:0}.left-panel-scrollable",t,"{position:absolute;height:100%;left:0;right:0;overflow-x:hidden;overflow-y:auto}"].join("")}];function ce(e,t,s,r){const{c:l,t:a,h:o,b:n,d:c,k:p,i:u,gid:h}=e,{_m0:b,_m1:m}=r;return[t.isLoading?l("base-spinner",d,{key:0},[]):null,o("div",{classMap:{"slds-tree_container":!0},key:17},[o("div",{key:2},[o("h2",{classMap:{"slds-tree__group-header":!0,"slds-truncate":!0},key:1},[a("SObjects")])]),o("div",{classMap:{"slds-form-element":!0,"slds-p-horizontal_large":!0},key:9},[o("label",{classMap:{"slds-form-element__label":!0,"slds-assistive-text":!0},key:3},[a("Filter sObjects")]),o("div",{classMap:{"slds-form-element__control":!0,"slds-input-has-icon":!0,"slds-input-has-icon_left":!0},key:8},[o("span",{classMap:{"slds-icon_container":!0,"slds-icon-utility-search":!0},key:6},[o("svg",{classMap:{"slds-icon":!0,"slds-input__icon":!0,"slds-input__icon_right":!0,"slds-icon-text-default":!0},attrs:{"aria-hidden":"true"},key:5},[o("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#search")},key:4},[])])]),o("input",{classMap:{"slds-input":!0},attrs:{type:"search",placeholder:"Quick Find"},key:7,on:{keyup:b||(r._m0=n(t.filterSObjects))}},[])])]),o("div",{classMap:{"sobjects-list":!0,"slds-border_top":!0},key:16},[t.isNoSObjects?o("div",{classMap:{"slds-p-around_small":!0},key:10},[a("No matching sObjects found")]):null,t.sobjects?o("ul",{classMap:{"slds-tree":!0,"left-panel-scrollable":!0},attrs:{"aria-describedby":""+h("entity-header")},key:15},u(t.sobjects,(function(e){return e.queryable?o("li",{attrs:{"aria-level":"1",role:"treeitem"},key:p(14,e.name)},[o("div",{classMap:{"slds-tree__item":!0},key:13},[o("span",{classMap:{"slds-has-flexi-truncate":!0},key:12},[o("a",{classMap:{"slds-tree__item-label":!0,"slds-truncate":!0},attrs:{title:e.itemLabel,"data-name":e.name},key:11,on:{click:m||(r._m1=n(t.selectSObject))}},[c(e.itemLabel)])])])]):null}))):null])])]}var de=Object(i.registerTemplate)(ce);ce.stylesheets=[],ne&&ce.stylesheets.push.apply(ce.stylesheets,ne),ce.stylesheetTokens={hostAttribute:"cmp-sobjectsPanel-_sobjectsPanel-host",shadowAttribute:"cmp-sobjectsPanel-_sobjectsPanel"};var pe=[function(e,t,s){return[".slds-notify__content",t,"{width:500px;max-width:100%}.error-details",t,"{max-height:300px}.slds-form-element__label",t,"{color:#fff}"].join("")}];function ue(e,t,s,r){const{t:l,h:a,d:o,k:n,i:c,gid:d,b:p}=e,{_m0:u,_m1:h}=r;return[a("div",{classMap:{"slds-notify_container":!0},key:23},[a("div",{classMap:{"slds-notify":!0,"slds-notify_toast":!0,"slds-theme_error":!0},attrs:{role:"status"},key:22},[a("span",{classMap:{"slds-assistive-text":!0},key:0},[l("error")]),a("span",{classMap:{"slds-icon_container":!0,"slds-icon-utility-error":!0,"slds-m-right_small":!0,"slds-no-flex":!0,"slds-align-top":!0},key:3},[a("svg",{classMap:{"slds-icon":!0,"slds-icon_small":!0},attrs:{"aria-hidden":"true"},key:2},[a("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#error")},key:1},[])])]),a("div",{classMap:{"slds-notify__content":!0},key:16},[a("h2",{classMap:{"slds-text-heading_small":!0},key:4},[o(t.message)]),t.errorMessages.length?a("ul",{classMap:{"slds-list_dotted":!0,"slds-p-top_small":!0},key:6},c(t.errorMessages,(function(e){return a("li",{key:n(5,e)},[o(e)])}))):null,a("div",{classMap:{"slds-p-vertical_x-small":!0},key:14},[a("div",{classMap:{"slds-form-element":!0},key:13},[a("div",{classMap:{"slds-form-element__control":!0},key:12},[a("div",{classMap:{"slds-checkbox":!0},key:11},[a("input",{attrs:{type:"checkbox",name:"options",id:d("checkbox-view-details")},props:{value:"true",checked:t.viewDetails},key:7,on:{change:u||(r._m0=p(t.handleCheckboxChange))}},[]),a("label",{classMap:{"slds-checkbox__label":!0},attrs:{for:""+d("checkbox-view-details")},key:10},[a("span",{classMap:{"slds-checkbox_faux":!0},key:8},[]),a("span",{classMap:{"slds-form-element__label":!0},key:9},[l("Show Details")])])])])])]),t.viewDetails?a("pre",{classMap:{"error-details":!0,"slds-box":!0,"slds-box_x-small":!0,"slds-theme_default":!0},key:15},[o(t.errorDetails)]):null]),a("div",{classMap:{"slds-notify__close":!0},key:21},[a("button",{classMap:{"slds-button":!0,"slds-button_icon":!0,"slds-button_icon-inverse":!0},attrs:{title:"Close"},key:20,on:{click:h||(r._m1=p(t.handleClose))}},[a("svg",{classMap:{"slds-button__icon":!0,"slds-button__icon_large":!0},attrs:{"aria-hidden":"true"},key:18},[a("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#close")},key:17},[])]),a("span",{classMap:{"slds-assistive-text":!0},key:19},[l("Close")])])])])])]}var he=Object(i.registerTemplate)(ue);function be(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function me(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?be(Object(s),!0).forEach((function(t){ye(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):be(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ye(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}ue.stylesheets=[],pe&&ue.stylesheets.push.apply(ue.stylesheets,pe),ue.stylesheetTokens={hostAttribute:"base-toast-_toast-host",shadowAttribute:"base-toast-_toast"};class _e extends i.LightningElement{constructor(...e){super(...e),this.message=void 0,this.errors=void 0,this.viewDetails=!1}get errorMessages(){return e=this.errors,Array.isArray(e)||(e=[e]),e.filter(e=>!!e).map(e=>"string"==typeof e.message?e.message:e.statusText).reduce((e,t)=>e.concat(t),[]).filter(e=>!!e);var e}get errorDetails(){return e=this.errors,JSON.stringify(e,(function(e,t){return t instanceof Error?me(me({},t),{},{name:t.name,message:t.message,stack:t.stack}):t}),2);var e}handleCheckboxChange(e){this.viewDetails=e.target.checked}handleClose(){this.template.host.remove()}}Object(i.registerDecorators)(_e,{publicProps:{message:{config:0},errors:{config:0}},fields:["viewDetails"]});var fe=Object(i.registerComponent)(_e,{tmpl:he});function ge(e){window.dispatchEvent(new CustomEvent("show-toast",{detail:e}))}function ve(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Oe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(s),!0).forEach((function(t){ke(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ve(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ke(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class je extends i.LightningElement{constructor(...e){super(...e),this.sobjects=void 0,this.isLoading=void 0,this._rawSObjects=void 0}get isNoSObjects(){return!(this.isLoading||this.sobjects&&this.sobjects.length)}storeChange({sobjects:e}){this._rawSObjects||(this.isLoading=e.isFetching,e.data?(this._rawSObjects=e.data.sobjects.map(e=>Oe(Oe({},e),{},{itemLabel:`${e.name} / ${e.label}`})),this.sobjects=this._rawSObjects):e.error&&(console.error(e.error),ge({message:"Failed to fetch sObjects.",errors:e.error}),te.dispatch({type:"CLEAR_SOBJECTS_ERROR"})))}filterSObjects(e){const t=e.target.value;if(t){const e=C(t),s=new RegExp(e,"i");this.sobjects=this._rawSObjects.filter(e=>s.test(`${e.name} ${e.label}`))}else this.sobjects=this._rawSObjects}selectSObject(e){const t=e.target.dataset.name;te.dispatch(function(e){return{type:"SELECT_SOBJECT",payload:{sObjectName:e}}}(t))}}Object(i.registerDecorators)(je,{wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["sobjects","isLoading","_rawSObjects"]});var we=Object(i.registerComponent)(je,{tmpl:de});var xe=[function(e,t,s){return[s?[".slds-tree_container",t,",:host{width:100%;display:flex}"].join(""):[".slds-tree_container",t,",",e,"{width:100%;display:flex}"].join(""),".slds-tree_container",t,"{flex-direction:column}.slds-tree__group-header",t,"{padding:.5rem;font-size:1rem;font-weight:700}.slds-tabs_default",t,"{display:flex;flex-direction:column;height:100%}.slds-tabs_default__item[aria-selected=true]",t,"{color:#080707}.slds-tabs_default__item[aria-selected=true]",t," .slds-tabs_default__link",t,"{font-weight:700}.slds-tabs_default__item[aria-selected=true]",t,":after{background-color:#1589ee;height:.1875rem}.slds-tabs_default__content",t,"{flex:1;position:relative;padding:0}.left-panel-scrollable",t,"{position:absolute;height:100%;left:0;right:0;overflow-x:hidden;overflow-y:auto}.slds-panel__header",t,"{padding:0 .75rem;border-top:1px solid #dddbda}.slds-panel__header-title",t,"{font-size:100%;font-weight:700;line-height:2.5rem;height:2.5rem}.dropdown-menu",t,"{position:absolute;top:0;right:7px;height:2.5rem;display:flex;align-items:center}"].join("")}];function Ee(e,t,s,r){const{h:l,d:a,b:o,s:n}=e,{_m0:c,_m1:d,_m2:p}=r;return[l("button",{classMap:{"slds-button":!0,"slds-button_icon":!0},attrs:{"aria-haspopup":"true",title:t.alternativeText},key:3,on:{click:c||(r._m0=o(t.toggleMenu)),blur:d||(r._m1=o(t.handleBlur))}},[l("svg",{classMap:{"slds-button__icon":!0},attrs:{"aria-hidden":"true"},key:1},[l("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#down")},key:0},[])]),l("span",{classMap:{"slds-assistive-text":!0},key:2},[a(t.alternativeText)])]),l("div",{classMap:{"slds-dropdown":!0,"slds-dropdown_right":!0},key:6},[l("ul",{classMap:{"slds-dropdown__list":!0},attrs:{role:"menu","aria-label":t.alternativeText},key:5,on:{privateselect:p||(r._m2=o(t.handleMenuItemPrivateSelect))}},[n("",{key:4},[],s)])])]}var Me=Object(i.registerTemplate)(Ee);Ee.slots=[""],Ee.stylesheets=[],a.a&&Ee.stylesheets.push.apply(Ee.stylesheets,a.a),Ee.stylesheetTokens={hostAttribute:"base-menu-_menu-host",shadowAttribute:"base-menu-_menu"};class Se extends i.LightningElement{constructor(...e){super(...e),this.alternativeText=void 0,this._closeMenuTimer=void 0}connectedCallback(){this.classList.add("slds-dropdown-trigger","slds-dropdown-trigger_click")}toggleMenu(){this.classList.toggle("slds-is-open")}handleBlur(){this._closeMenuTimer=setTimeout(()=>this._closeMenu(),10)}handleMenuItemPrivateSelect(e){clearTimeout(this._closeMenuTimer),e.stopPropagation(),this.dispatchEvent(new CustomEvent("select",{cancelable:!0,detail:{value:e.detail.value}})),this._closeMenu()}_closeMenu(){this.classList.remove("slds-is-open")}}Object(i.registerDecorators)(Se,{publicProps:{alternativeText:{config:0}},fields:["_closeMenuTimer"]});var Ce=Object(i.registerComponent)(Se,{tmpl:Me});function Re(e,t,s,r){const{fid:l,h:a,d:o,b:n}=e,{_m0:c}=r;return[a("a",{attrs:{href:"javascript:void(0);",role:"menuitem",tabindex:"-1"},key:3,on:{click:c||(r._m0=n(t.handleClick))}},[a("span",{classMap:{"slds-truncate":!0},attrs:{title:"Select All Fields"},key:2},[t.iconPath?a("svg",{classMap:{"slds-icon":!0,"slds-icon_x-small":!0,"slds-icon-text-default":!0,"slds-m-right_x-small":!0},attrs:{"aria-hidden":"true"},key:1},[a("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href",l(t.iconPath))},key:0},[])]):null,o(t.label)])])]}var Le=Object(i.registerTemplate)(Re);Re.stylesheets=[],a.a&&Re.stylesheets.push.apply(Re.stylesheets,a.a),Re.stylesheetTokens={hostAttribute:"base-menuItem-_menuItem-host",shadowAttribute:"base-menuItem-_menuItem"};class Pe extends i.LightningElement{constructor(...e){super(...e),this.iconName=void 0,this.label=void 0,this.value=void 0}get iconPath(){if(!this.iconName)return null;const e=this.iconName.split(":");return`./resources/slds/icons/${e[0]}-sprite/svg/symbols.svg#${e[1]}`}connectedCallback(){this.classList.add("slds-dropdown__item"),this.setAttribute("role","presentation")}handleClick(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("privateselect",{bubbles:!0,cancelable:!0,detail:{value:this.value}}))}}Object(i.registerDecorators)(Pe,{publicProps:{iconName:{config:0},label:{config:0},value:{config:0}}});var Te=Object(i.registerComponent)(Pe,{tmpl:Le});var Ae=[function(e,t,s){return[".slds-tree__item",t,"{padding-top:.2rem;padding-bottom:.2rem}.slds-tree__item",t," button[aria-hidden=true]",t,"{visibility:hidden}.slds-tree__item",t," .slds-text-color_error",t,"{padding-left:2rem}.field-details",t,"{font-size:.5rem;line-height:1;color:#919191}"].join("")}];function Fe(e,t,s,r){const{c:l,h:a,t:o,b:n,d:c,k:p,i:u}=e,{_m0:h,_m1:b}=r;return[t.isLoading?a("div",{classMap:{"slds-is-relative":!0},styleMap:{height:"2rem"},key:1},[l("base-spinner",d,{props:{size:"x-small"},key:0},[])]):null,t.isLoading?null:a("div",{key:18},[t.isNoFields?a("div",{classMap:{"slds-p-around_small":!0},key:2},[o("No matching fields found")]):null,t.isNoFields?null:a("ul",{classMap:{"slds-tree":!0},key:17},u(t.fields,(function(e){return a("li",{attrs:{"aria-level":t.level,"aria-selected":e.isActive,"aria-expanded":e.isExpanded,role:"treeitem"},key:p(16,e.name)},[a("div",{classMap:{"slds-tree__item":!0},key:10},[a("button",{classMap:{"slds-button":!0,"slds-button_icon":!0,"slds-m-right_x-small":!0},attrs:{"aria-hidden":e.isNotReference,tabindex:"-1",title:"Expand Reference Field","data-field":e.name},key:6,on:{click:h||(r._m0=n(t.toggleReferenceField))}},[a("svg",{classMap:{"slds-button__icon":!0,"slds-button__icon_small":!0},attrs:{"aria-hidden":"true"},key:4},[a("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#chevronright")},key:3},[])]),a("span",{classMap:{"slds-assistive-text":!0},key:5},[o("Expand Reference Field")])]),a("span",{classMap:{"slds-has-flexi-truncate":!0},attrs:{"data-name":e.name},key:9,on:{click:b||(r._m1=n(t.selectField))}},[a("a",{classMap:{"slds-tree__item-label":!0,"slds-truncate":!0},attrs:{title:e.name},key:7},[c(e.name)]),a("div",{classMap:{"field-details":!0},attrs:{title:e.details},key:8},[c(e.details)])])]),e.isExpanded&&t.isMaxLevel?a("ul",{classMap:{"slds-tree":!0},key:14},[a("li",{attrs:{"aria-level":t.level},key:13},[a("div",{classMap:{"slds-tree__item":!0},key:12},[a("div",{classMap:{"slds-text-color_error":!0},key:11},[o("No more than five levels can be specified in a child-to-parent relationship.")])])])]):null,e.isExpanded?t.isMaxLevel?null:e.relationshipPath?l("cmp-fields-tree",Qe,{props:{sobject:e.relationshipSObjectName,relationship:e.relationshipPath,rootlevel:t.rootlevel,childrelation:t.childrelation},key:15},[]):null:null])})))])]}var qe=Object(i.registerTemplate)(Fe);function De(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Ie(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?De(Object(s),!0).forEach((function(t){Ne(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):De(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ne(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Fe.stylesheets=[],Ae&&Fe.stylesheets.push.apply(Fe.stylesheets,Ae),Fe.stylesheetTokens={hostAttribute:"cmp-fieldsTree-_fieldsTree-host",shadowAttribute:"cmp-fieldsTree-_fieldsTree"};class Ue extends i.LightningElement{constructor(...e){super(...e),this.sobject=void 0,this.relationship=void 0,this.childrelation=void 0,this.rootlevel=1,this.sobjectMeta=void 0,this.fields=[],this.isLoading=void 0,this._keyword=void 0,this._rawFields=[],this._expandedFieldNames={}}get keyword(){return this._keyword}set keyword(e){this._keyword!==e&&(this._keyword=e,this._filterFields())}get level(){return this.relationship?this.relationship.split(".").length+this.rootLevelNum:this.rootLevelNum}get isMaxLevel(){return this.level>4+this.rootLevelNum}get rootLevelNum(){return parseInt(this.rootlevel,10)}get isNoFields(){return!this.fields||!this.fields.length}storeChange({sobject:e,ui:t}){const s=e[this.sobject];s&&(this.isLoading=s.isFetching,s.data&&(this.sobjectMeta=s.data),this._updateFields(t.query))}connectedCallback(){te.dispatch(le(this.sobject))}selectField(e){const t=e.currentTarget.dataset.name;te.dispatch(function(e,t,s){return{type:"TOGGLE_FIELD",payload:{fieldName:e,relationships:t,childRelationship:s}}}(t,this.relationship,this.childrelation))}toggleReferenceField(e){const t=e.target.dataset.field;this._expandedFieldNames[t]=!this._expandedFieldNames[t],this._filterFields()}_updateFields(e){if(!this.sobjectMeta)return;const t=this._getSelectedFields(e);this._rawFields=this.sobjectMeta.fields.map(e=>Ie(Ie({},e),{},{details:`${e.type.toUpperCase()} / ${e.label}`,isNotReference:"reference"!==e.type,isActive:t.includes(this._getRawFieldName(e)),isExpanded:!1},this._generateRelationshipProperties(e))),this._filterFields()}_getSelectedFields(e){if(!e)return[];if(this.childrelation){const t=e.fields.find(e=>{return"FieldSubquery"===e.type&&(t=e.subquery.relationshipName,s=this.childrelation,$(t)===$(s));var t,s});return t?this._getFlattenedFields(t):[]}return this._getFlattenedFields(e)}_getRawFieldName(e){let t;return t=this.relationship?`${this.relationship}.${e.name}`:e.name,$(t)}_getRelationshipPath(e){return this.relationship?`${this.relationship}.${e.relationshipName}`:e.relationshipName}_generateRelationshipProperties(e){return{relationshipSObjectName:e.referenceTo&&e.referenceTo.length>0?e.referenceTo[0]:void 0,relationshipPath:this._getRelationshipPath(e)}}_filterFields(){let e;if(1===this.level&&this.keyword){const t=C(this.keyword),s=new RegExp(t,"i");e=this._rawFields.filter(e=>s.test(`${e.name} ${e.label}`))}else e=this._rawFields;this.fields=e.map(e=>Ie(Ie({},e),{},{isExpanded:!!this._expandedFieldNames[e.name]}))}_getFlattenedFields(e){return Object(E.c)(e).map(e=>$(e))}}Object(i.registerDecorators)(Ue,{publicProps:{sobject:{config:0},relationship:{config:0},childrelation:{config:0},rootlevel:{config:0},keyword:{config:3}},wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["sobjectMeta","fields","isLoading","_keyword","_rawFields","_expandedFieldNames"]});var Qe=Object(i.registerComponent)(Ue,{tmpl:qe});var $e=[function(e,t,s){return[".slds-tree__item",t,"{padding-top:.2rem;padding-bottom:.2rem}.relationship-details",t,"{font-size:.5rem;line-height:1;color:#919191}"].join("")}];function Be(e,t,s,r){const{t:l,h:a,b:o,d:n,c:c,k:d,i:p}=e,{_m0:u,_m1:h}=r;return[t.isNoRelationships?a("div",{classMap:{"slds-p-around_small":!0},key:0},[l("No matching child relationships found")]):null,t.isNoRelationships?null:a("ul",{classMap:{"slds-tree":!0},key:11},p(t.relationships,(function(e){return e.relationshipName?a("li",{attrs:{"aria-level":"1","aria-selected":e.isActive,role:"treeitem"},key:d(10,e.relationshipName)},[a("div",{classMap:{"slds-tree__item":!0},key:8},[a("button",{classMap:{"slds-button":!0,"slds-button_icon":!0,"slds-m-right_x-small":!0},attrs:{"aria-hidden":"false",tabindex:"-1",title:"Expand Child Relationship","data-name":e.relationshipName},key:4,on:{click:u||(r._m0=o(t.toggleChildRelationship))}},[a("svg",{classMap:{"slds-button__icon":!0,"slds-button__icon_small":!0},attrs:{"aria-hidden":"true"},key:2},[a("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#chevronright")},key:1},[])]),a("span",{classMap:{"slds-assistive-text":!0},key:3},[l("Expand Child Relationship")])]),a("span",{classMap:{"slds-has-flexi-truncate":!0},attrs:{"data-name":e.relationshipName},key:7,on:{click:h||(r._m1=o(t.selectRelationship))}},[a("a",{classMap:{"slds-tree__item-label":!0,"slds-truncate":!0},attrs:{title:e.relationshipName},key:5},[n(e.relationshipName)]),a("div",{classMap:{"relationship-details":!0},attrs:{title:e.details},key:6},[n(e.details)])])]),e.isExpanded?c("cmp-fields-tree",Qe,{props:{sobject:e.childSObject,childrelation:e.relationshipName,rootlevel:"2"},key:9},[]):null]):null})))]}var ze=Object(i.registerTemplate)(Be);function Ve(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Je(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(s),!0).forEach((function(t){Ge(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ve(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ge(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Be.stylesheets=[],$e&&Be.stylesheets.push.apply(Be.stylesheets,$e),Be.stylesheetTokens={hostAttribute:"cmp-relationshipsTree-_relationshipsTree-host",shadowAttribute:"cmp-relationshipsTree-_relationshipsTree"};class He extends i.LightningElement{constructor(...e){super(...e),this.sobject=void 0,this.sobjectMeta=void 0,this.relationships=[],this._keyword=void 0,this._rawRelationships=[],this._expandedRelationshipNames={},this._sobjectLabelMap=void 0}get keyword(){return this._keyword}set keyword(e){this._keyword!==e&&(this._keyword=e,this._filterRelationships())}get isNoRelationships(){return!this.relationships||!this.relationships.length}storeChange({sobjects:e,sobject:t,ui:s}){!this._sobjectLabelMap&&e.data&&(this._sobjectLabelMap=this._getSObjectLabelMap(e.data));const i=t[this.sobject];i&&(i.data&&(this.sobjectMeta=i.data),this._updateRelationships(s.query))}selectRelationship(e){const t=e.currentTarget.dataset.name;te.dispatch(function(e){return{type:"TOGGLE_RELATIONSHIP",payload:{relationshipName:e}}}(t))}toggleChildRelationship(e){const t=e.target.dataset.name;this._expandedRelationshipNames[t]=!this._expandedRelationshipNames[t],this._filterRelationships()}_getSObjectLabelMap(e){return e.sobjects.reduce((e,t)=>Je(Je({},e),{},{[t.name]:t.label}),{})}_updateRelationships(e){if(!this.sobjectMeta)return;const t=e?this._getFlattenedFields(e):[];this._rawRelationships=this.sobjectMeta.childRelationships.map(e=>Je(Je({},e),{},{itemLabel:`${e.relationshipName} / ${e.childSObject}`,details:this._getRelationDetails(e),isActive:t.includes($(e.relationshipName)),isExpanded:!1})),this._filterRelationships()}_getRelationDetails(e){return`${e.childSObject} / ${this._sobjectLabelMap[e.childSObject]}`}_filterRelationships(){let e;if(this.keyword){const t=C(this.keyword),s=new RegExp(t,"i");e=this._rawRelationships.filter(e=>s.test(`${e.relationshipName} ${e.childSObject}`))}else e=this._rawRelationships;this.relationships=e.map(e=>Je(Je({},e),{},{isExpanded:!!this._expandedRelationshipNames[e.relationshipName]}))}_getFlattenedFields(e){return Object(E.c)(e).map(e=>$(e))}}Object(i.registerDecorators)(He,{publicProps:{sobject:{config:0},keyword:{config:3}},wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["sobjectMeta","relationships","_keyword","_rawRelationships","_expandedRelationshipNames","_sobjectLabelMap"]});var Ke=Object(i.registerComponent)(He,{tmpl:ze});function Ye(e,t,s,r){const{c:l,h:a,t:o,b:n,d:c,k:p,i:u}=e,{_m0:h,_m1:b,_m2:m,_m3:y}=r;return[t.isLoading?l("base-spinner",d,{key:0},[]):null,t.sobjectMeta?a("div",{classMap:{"slds-tree_container":!0},key:29},[a("div",{classMap:{"slds-p-left_small":!0},key:7},[a("div",{classMap:{"slds-grid":!0},key:6},[a("button",{classMap:{"slds-button":!0,"slds-button_icon":!0},attrs:{title:"Back"},key:4,on:{click:h||(r._m0=n(t.deselectSObject))}},[a("svg",{classMap:{"slds-button__icon":!0},attrs:{"aria-hidden":"true"},key:2},[a("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#back")},key:1},[])]),a("span",{classMap:{"slds-assistive-text":!0},key:3},[o("Back")])]),a("h2",{classMap:{"slds-tree__group-header":!0,"slds-truncate":!0},key:5},[c(t.sobjectMeta.name),o(" / "),c(t.sobjectMeta.label)])])]),a("div",{classMap:{"slds-form-element":!0,"slds-p-horizontal_large":!0},key:14},[a("label",{classMap:{"slds-form-element__label":!0,"slds-assistive-text":!0},key:8},[o("Filter fields")]),a("div",{classMap:{"slds-form-element__control":!0,"slds-input-has-icon":!0,"slds-input-has-icon_left":!0},key:13},[a("span",{classMap:{"slds-icon_container":!0,"slds-icon-utility-search":!0},key:11},[a("svg",{classMap:{"slds-icon":!0,"slds-input__icon":!0,"slds-input__icon_right":!0,"slds-icon-text-default":!0},attrs:{"aria-hidden":"true"},key:10},[a("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#search")},key:9},[])])]),a("input",{classMap:{"slds-input":!0},attrs:{type:"search",placeholder:"Quick Find"},key:12,on:{keyup:b||(r._m1=n(t.setKeyword))}},[])])]),a("div",{classMap:{"slds-tabs_default":!0,"slds-is-relative":!0},key:28},[a("ul",{classMap:{"slds-tabs_default__nav":!0},attrs:{role:"tablist"},key:17},u(t.tabs,(function(e){return a("li",{classMap:{"slds-tabs_default__item":!0},attrs:{"aria-selected":e.isActive,title:e.label},key:p(16,e.id)},[a("a",{classMap:{"slds-tabs_default__link":!0},attrs:{role:"tab",tabindex:"-1","data-id":e.id},key:15,on:{click:m||(r._m2=n(t.selectTab))}},[c(e.label)])])}))),t.isFieldsActive?a("div",{classMap:{"dropdown-menu":!0},key:21},[l("base-menu",Ce,{props:{alternativeText:"Show Menu"},key:20,on:{select:y||(r._m3=n(t.handleMenuSelect))}},[l("base-menu-item",Te,{props:{iconName:"utility:multi_select_checkbox",label:"Select All Fields",value:"select_all"},key:18},[]),l("base-menu-item",Te,{props:{iconName:"utility:clear",label:"Clear All Fields",value:"clear_all"},key:19},[])])]):null,t.isFieldsActive?a("div",{classMap:{"slds-tabs_default__content":!0},attrs:{role:"tabpanel"},key:24},[t.sobjectMeta?a("div",{classMap:{"left-panel-scrollable":!0},key:23},[l("cmp-fields-tree",Qe,{props:{sobject:t.sobjectMeta.name,keyword:t.keyword},key:22},[])]):null]):null,t.isRelationshipsActive?a("div",{classMap:{"slds-tabs_default__content":!0},attrs:{role:"tabpanel"},key:27},[t.sobjectMeta?a("div",{classMap:{"left-panel-scrollable":!0},key:26},[l("cmp-relationships-tree",Ke,{props:{sobject:t.sobjectMeta.name,keyword:t.keyword},key:25},[])]):null]):null])]):null]}var We=Object(i.registerTemplate)(Ye);function Ze(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Xe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(s),!0).forEach((function(t){et(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ze(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function et(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Ye.stylesheets=[],xe&&Ye.stylesheets.push.apply(Ye.stylesheets,xe),Ye.stylesheetTokens={hostAttribute:"cmp-fieldsPanel-_fieldsPanel-host",shadowAttribute:"cmp-fieldsPanel-_fieldsPanel"};class tt extends i.LightningElement{constructor(...e){super(...e),this.tabs=[{id:"tab-fields",label:"Fields",isActive:!0},{id:"tab-relationships",label:"Child Relationships",isActive:!1}],this.sobjectMeta=void 0,this.keyword=void 0,this.isLoading=void 0,this._selectedSObject=void 0}storeChange({sobjects:e,sobject:t,ui:s}){const{selectedSObject:i}=s;if(!i)return;const r=$(i);if(e&&!e.data.sobjects.find(e=>e.name===r))return;r!==this._selectedSObject&&(this._selectedSObject=r,te.dispatch(le(this._selectedSObject)));const l=t[this._selectedSObject];l&&(this.isLoading=l.isFetching,l.data?this.sobjectMeta=l.data:l.error&&(console.error(l.error),ge({message:"Failed to describe sObject",errors:l.error}),te.dispatch({type:"CLEAR_SOBJECT_ERROR",payload:{sObjectName:this._selectedSObject}})))}get isFieldsActive(){return!!this.tabs.find(e=>"tab-fields"===e.id&&e.isActive)}get isRelationshipsActive(){return!!this.tabs.find(e=>"tab-relationships"===e.id&&e.isActive)}deselectSObject(){te.dispatch({type:"DESELECT_SOBJECT"})}selectTab(e){const t=e.target.dataset.id;this.tabs=this.tabs.map(e=>Xe(Xe({},e),{},{isActive:e.id===t}))}setKeyword(e){this.keyword=e.target.value}handleMenuSelect(e){switch(e.detail.value){case"select_all":te.dispatch({type:"SELECT_ALL_FIELDS",payload:{sObjectMeta:this.sobjectMeta}});break;case"clear_all":te.dispatch({type:"CLEAR_ALL_FIELDS"})}}}Object(i.registerDecorators)(tt,{wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["tabs","sobjectMeta","keyword","isLoading","_selectedSObject"]});var st=Object(i.registerComponent)(tt,{tmpl:We});var it=[function(e,t,s){return[s?":host{flex:1;display:flex;flex-direction:column}":[e,"{flex:1;display:flex;flex-direction:column}"].join(""),".soql-editor",t,"{position:relative;flex:1;display:flex}.soql-editor",t," textarea",t,"{flex:1}.completion-popover",t,"{position:absolute;width:300px;max-height:100%;overflow:auto}.slds-listbox__option[aria-selected=true]",t,"{background:rgba(21,137,238,.1);box-shadow:inset .25rem 0 0 #1589ee}"].join("")}];function rt(e,t,s,i){const{t:r,b:l,h:a,d:o,k:n,i:c}=e,{_m0:d,_m1:p,_m2:u,_m3:h,_m4:b,_m5:m,_m6:y}=i;return[a("div",{classMap:{"slds-p-around_small":!0},key:3},[a("button",{classMap:{"slds-button":!0,"slds-button_brand":!0},key:0,on:{click:d||(i._m0=l(t.runQuery))}},[r("Query")]),a("button",{classMap:{"slds-button":!0,"slds-button_brand":!0},attrs:{title:"Query All will return records that have been deleted"},key:1,on:{click:p||(i._m1=l(t.runQueryAll))}},[r("Query All")]),a("button",{classMap:{"slds-button":!0,"slds-button_neutral":!0},key:2,on:{click:u||(i._m2=l(t.formatQuery))}},[r("Format SOQL")])]),a("div",{classMap:{"soql-editor":!0,"slds-m-horizontal_small":!0,"slds-m-bottom_small":!0},key:11},[a("textarea",{classMap:{"slds-textarea":!0,"soql-input":!0},attrs:{placeholder:"Input SOQL"},key:4,on:{keydown:h||(i._m3=l(t.handleKeydownSoql)),keyup:b||(i._m4=l(t.handleKeyupSoql)),blur:m||(i._m5=l(t.handleBlurSoql))}},[]),t.isCompletionVisible?a("div",{classMap:{"completion-popover":!0,"slds-popover":!0},style:t.completionStyle,key:10},[a("ul",{classMap:{"slds-listbox":!0,"slds-listbox_vertical":!0},attrs:{role:"presentation"},key:9},c(t.completionFields,(function(e){return a("li",{classMap:{"slds-listbox__item":!0},attrs:{role:"presentation"},key:n(8,e.name)},[a("div",{classMap:{"slds-media":!0,"slds-listbox__option":!0,"slds-listbox__option_plain":!0,"slds-media_small":!0},attrs:{"aria-selected":e.isActive,role:"option"},key:7},[a("span",{classMap:{"slds-media__body":!0},key:6},[a("span",{classMap:{"slds-truncate":!0},attrs:{title:e.itemLabel,"data-name":e.name},key:5,on:{click:y||(i._m6=l(t.insertField))}},[o(e.itemLabel)])])])])})))]):null])]}var lt=Object(i.registerTemplate)(rt);rt.stylesheets=[],it&&rt.stylesheets.push.apply(rt.stylesheets,it),rt.stylesheetTokens={hostAttribute:"cmp-queryEditorPanel-_queryEditorPanel-host",shadowAttribute:"cmp-queryEditorPanel-_queryEditorPanel"};var at=s(104),ot=s.n(at);function nt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ct(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(s),!0).forEach((function(t){dt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):nt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function dt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class pt extends i.LightningElement{constructor(...e){super(...e),this.isCompletionVisible=void 0,this.completionStyle=void 0,this.completionFields=void 0,this._sobjectMeta=void 0,this._selectionStart=void 0,this._soql=void 0}get soql(){return this._soql}set soql(e){this._soql=e;const t=this.template.querySelector(".soql-input");t&&(t.value=e)}storeChange({sobject:e,ui:t}){const{query:s,soql:i}=t;if(e&&s){const t=e[$(s.sObject)];t&&(this._sobjectMeta=t.data)}i!==this.soql&&(this.soql=i)}runQuery(){this._runQuery()}runQueryAll(){this._runQuery(!0)}formatQuery(){te.dispatch({type:"FORMAT_SOQL"})}insertField(e){const t=e.target.dataset.name;this._closeCompletionTimer&&clearTimeout(this._closeCompletionTimer);const s=this.completionFields.find(e=>e.name===t),i=this.template.querySelector(".soql-input");this._insertField(i,s)}handleKeyupSoql(e){const{value:t}=e.target;this._soql!==t&&te.dispatch(ie(t)),this._sobjectMeta&&(this.isCompletionVisible?this._handleCompletion(e):this._openCompletion(e))}handleKeydownSoql(e){const{key:t,isComposing:s}=e;if(this.isCompletionVisible){if(s)return;switch(t){case"ArrowDown":this._selectBellowField(e);break;case"ArrowUp":this._selectAboveField(e);break;case"Enter":this._insertFieldByKeyboard(e)}}else s&&"Enter"===t&&this._openCompletion(e)}handleBlurSoql(){this._closeCompletionTimer=setTimeout(()=>this._closeCompletion(),100)}_runQuery(e){const t=this.template.querySelector(".soql-input");if(!t)return;const s=t.value;s&&te.dispatch(function(e,t){const s=t?"/queryAll":"/query";return async t=>{N()&&(t({type:"REQUEST_QUERY"}),L.request({method:"GET",url:`${s}?q=${encodeURIComponent(e)}`,headers:U()}).then(s=>{t(function(e,t){return{type:"RECEIVE_QUERY_SUCCESS",payload:{data:e,soql:t}}}(s,e)),t({type:"UPDATE_API_LIMIT"})}).catch(e=>{t({type:"RECEIVE_QUERY_ERROR",payload:{error:e}})}))}}(s,e))}_openCompletion(e){const{target:t}=e;this._selectionStart=this._findSeparator(t.value.substring(0,t.selectionEnd))||t.selectionEnd,this._canOpenCompletion(e)&&this._searchCompletionFields(e)}_canOpenCompletion(e){const{key:t,altKey:s,ctrlKey:i,metaKey:r,isComposing:l}=e;return i&&" "===t||1===t.length&&![" ",",","."].includes(t)&&!s&&!i&&!r&&!l||l&&"Enter"===t}_findSeparator(e){const t=/[,. ][^,. ]*$/g.exec(e);return t&&t.index+1}_closeCompletion(){this.isCompletionVisible=!1}_setCompletionPosition(e){const{target:t}=e,s=ot()(t,t.selectionStart);this.completionStyle=`top:${s.top+s.height}px;left:${s.left}px;`}_searchCompletionFields(e){const{target:t}=e,s=C(t.value.substring(this._selectionStart,t.selectionEnd)),i=new RegExp(s,"i");this.completionFields=this._sobjectMeta.fields.filter(e=>i.test(`${e.name} ${e.label}`)).map((e,t)=>ct(ct({},e),{},{itemLabel:`${e.name} / ${e.label}`,isActive:0===t})),this.completionFields.length>0?(this._setCompletionPosition(e),this.isCompletionVisible=!0):this.isCompletionVisible=!1}_handleCompletion(e){const{key:t,altKey:s,ctrlKey:i,metaKey:r}=e;switch((s||i||r)&&this._closeCompletion(),t){case".":case",":case" ":case"Escape":case"ArrowLeft":case"ArrowRight":this._closeCompletion();break;case"Backspace":this._deleteKeyword(e);break;case"ArrowDown":case"ArrowUp":case"Enter":e.isComposing&&this._searchCompletionFields(e);break;default:this._searchCompletionFields(e)}}_deleteKeyword(e){this._searchCompletionFields(e),this._selectionStart===e.target.selectionStart&&this._closeCompletion()}_selectBellowField(e){e.preventDefault();const t=this._getActiveFieldIndex();t+1<this.completionFields.length&&(this.completionFields=this.completionFields.map((e,s)=>ct(ct({},e),{},{isActive:s===t+1})))}_selectAboveField(e){e.preventDefault();const t=this._getActiveFieldIndex();t>0&&(this.completionFields=this.completionFields.map((e,s)=>ct(ct({},e),{},{isActive:s===t-1})))}_getActiveFieldIndex(){return this.completionFields.findIndex(e=>e.isActive)}_insertFieldByKeyboard(e){e.preventDefault();const t=this.completionFields.find(e=>e.isActive),{target:s}=e;this._insertField(s,t)}_insertField(e,t){if(t){const s=e.value,i=s.substring(0,this._selectionStart),r=s.substring(e.selectionStart),l=z(t.name);this.soql=i+l+r;const a=this._selectionStart+l.length;e.focus(),e.setSelectionRange(a,a),te.dispatch(ie(this.soql))}this._closeCompletion()}}Object(i.registerDecorators)(pt,{wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["isCompletionVisible","completionStyle","completionFields","_sobjectMeta","_selectionStart","_soql"]});var ut=Object(i.registerComponent)(pt,{tmpl:lt});var ht=[function(e,t,s){return[s?":host{width:100%}":[e,"{width:100%}"].join(""),".slds-tabs_default",t,"{height:100%;display:flex;flex-direction:column}.slds-tabs_default__content",t,"{padding:0;flex:1}.slds-scrollable",t,"{position:absolute;top:0;bottom:0;right:0;left:0}.recent-query-item",t,"{overflow:hidden}.recent-query-item:hover",t,"{background:#f3f2f2;cursor:pointer}"].join("")}];function bt(e,t,s,i){const{t:r,gid:l,h:a,d:o,k:n,b:c,i:d}=e,{_m0:p}=i;return[a("div",{classMap:{"slds-tabs_default":!0},key:6},[a("ul",{classMap:{"slds-tabs_default__nav":!0},attrs:{role:"tablist"},key:2},[a("li",{classMap:{"slds-tabs_default__item":!0,"slds-is-active":!0},attrs:{title:"Recent Queries",role:"presentation"},key:1},[a("a",{classMap:{"slds-tabs_default__link":!0},attrs:{href:"javascript:void(0);",role:"tab",tabindex:"-1","aria-selected":"false","aria-controls":""+l("tab-recent-queries"),id:l("tab-recent-queries__item")},key:0},[r("Recent Queries")])])]),a("div",{classMap:{"slds-tabs_default__content":!0},attrs:{id:l("tab-recent-queries"),role:"tabpanel","aria-labelledby":""+l("tab-recent-queries__item")},key:5},[a("div",{classMap:{"slds-scrollable":!0},key:4},d(t.recentQueries,(function(e){return a("div",{classMap:{"slds-p-around_small":!0,"slds-border_bottom":!0,"recent-query-item":!0},attrs:{title:e.soql,"data-key":e.key},key:n(3,e.key),on:{click:p||(i._m0=c(t.selectQuery))}},[o(e.soql)])})))])])]}var mt=Object(i.registerTemplate)(bt);bt.stylesheets=[],ht&&bt.stylesheets.push.apply(bt.stylesheets,ht),bt.stylesheetTokens={hostAttribute:"cmp-queryListPanel-_queryListPanel-host",shadowAttribute:"cmp-queryListPanel-_queryListPanel"};class yt extends i.LightningElement{constructor(...e){super(...e),this.recentQueries=void 0}storeChange({ui:e}){e.recentQueries&&(this.recentQueries=e.recentQueries.map((e,t)=>({key:""+t,soql:e})))}connectedCallback(){te.dispatch({type:"LOAD_RECENT_QUERIES"})}selectQuery(e){const{key:t}=e.target.dataset,s=this.recentQueries.find(e=>e.key===t);s&&te.dispatch(ie(s.soql))}}Object(i.registerDecorators)(yt,{wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["recentQueries"]});var _t=Object(i.registerComponent)(yt,{tmpl:mt});var ft=[function(e,t,s){return[s?":host{flex:1;display:flex;flex-direction:column;position:relative}":[e,"{flex:1;display:flex;flex-direction:column;position:relative}"].join(""),".child-relationsihp-panel",t,"{position:relative;flex:1;display:flex}.child-relationsihp-panel",t," .slds-button",t,"{position:absolute;top:.25rem;right:.25rem;z-index:100}"].join("")}];var gt=[function(e,t,s){return[s?":host{flex:1;flex-direction:column;display:flex}":[e,"{flex:1;flex-direction:column;display:flex}"].join(""),".output-panel",t,"{position:relative;flex:1}.slds-table--header-fixed_container",t,"{position:absolute;min-width:100%;height:100%;left:0;border-top:1px solid #dddbda;border-right:1px solid #dddbda}.slds-cell-fixed",t,",td",t,",th",t,"{max-width:400px;min-width:50px}.slds-cell-fixed",t,"{padding-left:.5rem;transform:translate(-.25rem);line-height:2rem}.slds-cell-fixed",t,':before{content:"";border-left:1px solid #dddbda;position:absolute;height:2rem;left:calc(.25rem - 1px)}'].join("")}];var vt=[function(e,t,s){return s?":host{display:flex}":[e,"{display:flex}"].join("")}];function Ot(e,t,s,r){const{h:l,t:a,b:o,d:n}=e,{_m0:c}=r;return[t.isChildRelationship?l("button",{classMap:{"slds-button":!0,"slds-button_icon":!0,"slds-m-right_xx-small":!0},attrs:{title:"Show Child Relationship"},key:3,on:{click:c||(r._m0=o(t.handleClick))}},[l("svg",{classMap:{"slds-button__icon":!0,"slds-button__icon_small":!0},attrs:{"aria-hidden":"true"},key:1},[l("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#record_lookup")},key:0},[])]),l("span",{classMap:{"slds-assistive-text":!0},key:2},[a("Show Child Relationship")])]):null,l("div",{classMap:{"slds-truncate":!0},attrs:{title:t.value.data},key:5},[t.url?l("a",{attrs:{href:t.url,target:"_blank",tabindex:"-1"},key:4},[n(t.value.data)]):null,t.url?null:n(t.value.data)])]}var kt=Object(i.registerTemplate)(Ot);Ot.stylesheets=[],vt&&Ot.stylesheets.push.apply(Ot.stylesheets,vt),Ot.stylesheetTokens={hostAttribute:"cmp-outputCell-_outputCell-host",shadowAttribute:"cmp-outputCell-_outputCell"};class jt extends i.LightningElement{constructor(...e){super(...e),this.value=void 0}get isChildRelationship(){return this.value&&this.value.rawData&&this.value.rawData.totalSize}get url(){return/^[0-9A-Za-z]{18}$/.test(this.value.data)?`${L.instanceUrl}/${this.value.data}`:null}handleClick(){te.dispatch({type:"SELECT_CHILD_RELATIONSHIP",payload:{childRelationship:this.value.rawData}})}}Object(i.registerDecorators)(jt,{publicProps:{value:{config:0}}});var wt=Object(i.registerComponent)(jt,{tmpl:kt});function xt(e,t,s,i){const{d:r,h:l,k:a,i:o,c:n,b:c}=e,{_m0:d}=i;return[l("div",{classMap:{"output-panel":!0,"slds-scrollable_x":!0},key:11},[l("div",{classMap:{"slds-table--header-fixed_container":!0},key:10},[l("div",{classMap:{"slds-scrollable_y":!0},key:9,on:{scroll:d||(i._m0=c(t.handleScroll))}},[l("table",{classMap:{"slds-table":!0,"slds-table_bordered":!0,"slds-table_col-bordered":!0,"slds-table--header-fixed":!0},key:8},[l("thead",{key:3},[l("tr",{classMap:{"slds-line-height_reset":!0},key:2},o(t.columns,(function(e){return l("th",{classMap:{},attrs:{scope:"col"},key:a(1,e)},[l("div",{classMap:{"slds-cell-fixed":!0,"slds-truncate":!0},attrs:{title:e},key:0},[r(e)])])})))]),l("tbody",{key:7},o(t.rows,(function(e){return l("tr",{classMap:{"slds-hint-parent":!0},key:a(6,e.key)},o(e.values,(function(e){return l("td",{key:a(5,e.key)},[n("cmp-output-cell",wt,{props:{value:e},key:4},[])])})))})))])])])])]}var Et=Object(i.registerTemplate)(xt);xt.stylesheets=[],gt&&xt.stylesheets.push.apply(xt.stylesheets,gt),xt.stylesheetTokens={hostAttribute:"cmp-outputTable-_outputTable-host",shadowAttribute:"cmp-outputTable-_outputTable"};class Mt{constructor(e){this.columnMap=new Map,this.columns=[],this.records=void 0,this.records=e}collect(){return this.records.forEach(e=>{this._collectColumnMap(e)}),this._collectColumns(),this.columns}_collectColumnMap(e,t=[]){Object.keys(e).forEach(s=>{if("attributes"!==s){let i=this.columnMap;t.forEach(e=>{i=i.get(e)}),i.has(s)||i.set(s,new Map);const r=e[s];r instanceof Object&&(r.totalSize||this._collectColumnMap(r,[...t,s]))}})}_collectColumns(e=this.columnMap,t=[]){for(let[s,i]of e)i.size?this._collectColumns(i,[...t,s]):this.columns.push([...t,s].join("."))}}Object(i.registerDecorators)(Mt,{fields:["columnMap","columns","records"]});class St extends i.LightningElement{constructor(...e){super(...e),this.columns=void 0,this.rows=void 0,this._response=void 0,this._nextRecordsUrl=void 0,this._allRows=void 0}set response(e){this._response=e,this._nextRecordsUrl=e.nextRecordsUrl;const t=new Mt(e.records);this.columns=t.collect();const s=this._convertQueryResponse(e);this._allRows=s,this.rows=s.slice(0,200)}get response(){return this._response}async generateCsv(){const e=e=>/[\n",]/.test(e)?`"${e.replace(/"/g,'""')}"`:e;await this._fetchSubsequentRecords(this._nextRecordsUrl);return`${this.columns.map(e).join(",")}\n${this._allRows.map(t=>t.values.map(t=>e(t.data)).join(",")).join("\n")}`}handleScroll(e){const{target:t}=e;if(t.scrollTop+t.clientHeight>=t.scrollHeight){const e=this.rows.length;e<this._allRows.length&&(this.rows=[...this.rows,...this._allRows.slice(e,e+200)]);const{totalSize:t}=this._response;this._nextRecordsUrl&&this._allRows.length<t&&e>=this._allRows.length-400&&(this._fetchNextRecords(this._nextRecordsUrl).catch(e=>{console.error(e),ge({message:"Failed to fetch next records",errors:e})}),this._nextRecordsUrl=null)}}_convertQueryResponse(e){if(!e)return[];const t=this._allRows?this._allRows.length:0;return e.records.map((e,s)=>{const i=t+s;let r={key:i,values:[]};return this.columns.forEach((t,s)=>{const l=this._getFieldValue(t,e);let a=l;a&&a.totalSize&&(a=a.totalSize+" rows"),r.values.push({key:`${i}-${s}`,data:a,rawData:l,column:t})}),r})}_getFieldValue(e,t){let s=t;return e.split(".").forEach(e=>{s&&(s=s[e])}),s}async _fetchNextRecords(e){if(!e)return;const t=await L.request({method:"GET",url:e,headers:U()});this._nextRecordsUrl=t.nextRecordsUrl,this._allRows=[...this._allRows,...this._convertQueryResponse(t)]}async _fetchSubsequentRecords(e){await this._fetchNextRecords(e),this._nextRecordsUrl&&await this._fetchSubsequentRecords(this._nextRecordsUrl)}}Object(i.registerDecorators)(St,{publicProps:{response:{config:3}},publicMethods:["generateCsv"],fields:["columns","rows","_response","_nextRecordsUrl","_allRows"]});var Ct=Object(i.registerComponent)(St,{tmpl:Et});function Rt(e,t,s,r){const{c:l,t:a,b:o,h:n,d:c}=e,{_m0:p,_m1:u}=r;return[t.isLoading?l("base-spinner",d,{key:0},[]):null,t.response?n("div",{classMap:{"slds-p-around_small":!0,"slds-grid":!0},key:3},[n("button",{classMap:{"slds-button":!0,"slds-button_neutral":!0},key:1,on:{click:p||(r._m0=o(t.exportCsv))}},[a("Export CSV")]),n("div",{classMap:{"slds-p-around_x-small":!0,"slds-col_bump-left":!0},key:2},[a("Total: "),c(t.response.totalSize)])]):null,t.response?l("cmp-output-table",Ct,{classMap:{"main-output":!0},props:{response:t.response},key:4},[]):null,t.response&&t.childResponse?n("div",{classMap:{"child-relationsihp-panel":!0},key:10},[n("button",{classMap:{"slds-button":!0,"slds-button_icon":!0},attrs:{title:"Close Child Relationship"},key:8,on:{click:u||(r._m1=o(t.closeChildRelationship))}},[n("svg",{classMap:{"slds-button__icon":!0},attrs:{"aria-hidden":"true"},key:6},[n("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","./resources/slds/icons/utility-sprite/svg/symbols.svg#close")},key:5},[])]),n("span",{classMap:{"slds-assistive-text":!0},key:7},[a("Close Child Relationship")])]),l("cmp-output-table",Ct,{props:{response:t.childResponse},key:9},[])]):null]}var Lt=Object(i.registerTemplate)(Rt);Rt.stylesheets=[],ft&&Rt.stylesheets.push.apply(Rt.stylesheets,ft),Rt.stylesheetTokens={hostAttribute:"cmp-outputPanel-_outputPanel-host",shadowAttribute:"cmp-outputPanel-_outputPanel"};class Pt extends i.LightningElement{constructor(...e){super(...e),this.response=void 0,this.childResponse=void 0,this.isLoading=void 0,this._sObject=void 0}storeChange({query:e,ui:t}){this.isLoading=e.isFetching,e.data?this.response!==e.data&&(this.response=e.data,this._sObject=t.query.sObject):this.response=void 0,e.error&&(console.error(e.error),ge({message:"Failed to execute SOQL",errors:e.error}),te.dispatch({type:"CLEAR_QUERY_ERROR"})),this.childResponse=t.childRelationship}closeChildRelationship(){te.dispatch({type:"DESELECT_CHILD_RELATIONSHIP"})}async exportCsv(){this.isLoading=!0;try{const e=await this.template.querySelector("cmp-output-table.main-output").generateCsv(),t=new Uint8Array([239,187,191]),s=new Blob([t,e],{type:"text/csv"}),i=URL.createObjectURL(s),r=document.createElement("a");r.href=window.URL.createObjectURL(s),r.download=this._sObject+".csv",r.click(),URL.revokeObjectURL(i)}catch(e){console.error(e),ge({message:"Failed to export CSV",errors:e})}this.isLoading=!1}}Object(i.registerDecorators)(Pt,{wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["response","childResponse","isLoading","_sObject"]});var Tt=Object(i.registerComponent)(Pt,{tmpl:Lt});var At=[function(e,t,s){return[".slds-welcome-mat__info",t,"{background-image:url(resources/slds/images/welcome-mat/bg-info@2x.png)}.logo",t,"{height:60px}"].join("")}];function Ft(e,t,s,i){const{h:r,t:l,b:a}=e,{_m0:o,_m1:n}=i;return[r("section",{classMap:{"slds-modal":!0,"slds-fade-in-open":!0,"slds-modal_small":!0},attrs:{role:"dialog",tabindex:"-1","aria-modal":"true"},key:16},[r("div",{classMap:{"slds-modal__container":!0},key:15},[r("div",{classMap:{"slds-modal__content":!0},key:14},[r("div",{classMap:{"slds-welcome-mat":!0,"slds-welcome-mat_splash":!0},key:13},[r("div",{classMap:{"slds-welcome-mat__content":!0,"slds-grid":!0},key:12},[r("div",{classMap:{"slds-welcome-mat__info":!0,"slds-size_1-of-1":!0},key:11},[r("div",{classMap:{"slds-welcome-mat__info-content":!0},key:10},[r("div",{classMap:{"slds-m-bottom_x-large":!0},key:1},[r("img",{classMap:{logo:!0},attrs:{src:"./resources/imgs/logo.svg"},key:0},[])]),r("h2",{classMap:{"slds-welcome-mat__info-title":!0},key:2},[l("Welcome to LWC SOQL Builder!")]),r("div",{classMap:{"slds-welcome-mat__info-description":!0,"slds-text-longform":!0},key:4},[r("p",{key:3},[l("LWC SOQL Builder is a SOQL execution tool developed in Lightning Web Components Open Source, which provides useful features such as viewing the list of items, completing item names, saving queries, and exporting execution results to CSV.")])]),r("div",{classMap:{"slds-welcome-mat__info-actions":!0},key:7},[r("button",{classMap:{"slds-button":!0,"slds-button_brand":!0},key:5,on:{click:o||(i._m0=a(t.loginProduction))}},[l("Login to Production Org")]),r("button",{classMap:{"slds-button":!0,"slds-button_brand":!0},key:6,on:{click:n||(i._m1=a(t.loginSandbox))}},[l("Login to Sandbox Org")])]),r("div",{classMap:{"slds-welcome-mat__info-actions":!0,"slds-m-top_small":!0},key:9},[r("a",{classMap:{"slds-button":!0},attrs:{href:"/"},key:8},[l("Back to Home")])])])])])])])])]),r("div",{classMap:{"slds-backdrop":!0,"slds-backdrop_open":!0},key:17},[])]}var qt=Object(i.registerTemplate)(Ft);Ft.stylesheets=[],At&&Ft.stylesheets.push.apply(Ft.stylesheets,At),Ft.stylesheetTokens={hostAttribute:"cmp-welcomeModal-_welcomeModal-host",shadowAttribute:"cmp-welcomeModal-_welcomeModal"};class Dt extends i.LightningElement{loginProduction(){I("https://login.salesforce.com")}loginSandbox(){I("https://test.salesforce.com")}}var It=Object(i.registerComponent)(Dt,{tmpl:qt});function Nt(e,t,s,i){const{c:r,h:l}=e;return[t.isLoading?r("base-spinner",d,{key:0},[]):null,l("div",{classMap:{app:!0},key:15},[l("div",{key:2},[r("cmp-header",oe,{key:1},[])]),l("div",{classMap:{body:!0},key:14},[l("div",{classMap:{"left-panel":!0},key:5},[r("cmp-sobjects-panel",we,{className:t.sobjectsPanelClass,key:3},[]),t.selectedSObject?r("cmp-fields-panel",st,{key:4},[]):null]),l("div",{classMap:{"right-panel":!0},key:13},[l("div",{classMap:{"right-top-panel":!0},key:10},[l("div",{classMap:{"right-top-left-panel":!0},key:7},[r("cmp-query-editor-panel",ut,{key:6},[])]),l("div",{classMap:{"right-top-right-panel":!0},key:9},[r("cmp-query-list-panel",_t,{key:8},[])])]),l("div",{classMap:{"right-bottom-panel":!0},key:12},[r("cmp-output-panel",Tt,{key:11},[])])])])]),t.isLoggedIn?null:r("cmp-welcome-modal",It,{key:16},[])]}var Ut=Object(i.registerTemplate)(Nt);Nt.stylesheets=[],r&&Nt.stylesheets.push.apply(Nt.stylesheets,r),Nt.stylesheetTokens={hostAttribute:"app-container-_container-host",shadowAttribute:"app-container-_container"};class Qt extends i.LightningElement{get sobjectsPanelClass(){return this.selectedSObject?"slds-hide":""}storeChange({ui:e}){this.isLoggedIn=e.isLoggedIn,e.selectedSObject?this.selectedSObject=e.selectedSObject:this.selectedSObject=null}constructor(){super(),this.isLoading=void 0,this.isLoggedIn=void 0,this.selectedSObject=void 0,this.isLoading=!0,function(e){const t=window.location.hash;S.a.browser.init(F()),S.a.browser.on("disconnect",()=>{localStorage.removeItem("lsb.accessToken"),localStorage.removeItem("lsb.instanceUrl")});const s=localStorage.getItem("lsb.accessToken"),i=localStorage.getItem("lsb.instanceUrl");if(s&&i)return L=new S.a.Connection({accessToken:s,instanceUrl:i,version:T,proxyUrl:A()}),void q(e);S.a.browser.on("connect",t=>{localStorage.setItem("lsb.accessToken",t.accessToken),localStorage.setItem("lsb.instanceUrl",t.instanceUrl),L=t,q(e)}),t&&S.a.browser.init(F()),!t&&e&&e()}(this._loginCallback.bind(this)),window.addEventListener("show-toast",e=>{const{detail:t}=e;if(!t)return;const{message:s="Unexpected error occured.",errors:r=[]}=t,l=Object(i.createElement)("base-toast",{is:fe});l.message=s,l.errors=r,document.body.appendChild(l)})}_loginCallback(e,t){if(this.isLoading=!1,e)return console.error(e),void ge({message:"Failed to fetch login user. Your token is expired. Please login again.",errors:e});t&&(te.dispatch(function(e){return{type:"LOGIN",payload:{user:e}}}(t)),te.dispatch(re()))}}Object(i.registerDecorators)(Qt,{wire:{storeChange:{adapter:se,dynamic:[],method:1,config:function(e){return{store:te}}}},fields:["isLoading","isLoggedIn","selectedSObject"]});var $t=Object(i.registerComponent)(Qt,{tmpl:Ut});const Bt={"Service Worker":"serviceWorker"in navigator};Object.keys(Bt).some(e=>!Bt[e])?function(){const{outdated:e}=window;e.style.display="unset";let t="This browser doesn't support all the required features";t+="<ul>";for(const[e,s]of Object.entries(Bt))t+=`<li><b>${e}:<b> ${s?"":""}</li>`;t+="</ul>",e.querySelector(".unsupported_message").innerHTML=t}():(customElements.define("app-container",$t.CustomElementConstructor),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js"),console.log("Service worker registered")}))}});